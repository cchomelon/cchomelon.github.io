---
layout: base.njk
title: Shallow-Water Equation for busy people
tags: post
categories: ["Physics"]
---
## Mathematical Model
The 2D shallow water system for the free-surface flow with the Coriolis effect and bottom friction stress is formulated as,

$$
\begin{cases}
\partial_t H + \nabla \cdot (H \mathbf{u}) = 0, \\
\partial_t (H \mathbf{u}) + \nabla \cdot (H \mathbf{u} \otimes \mathbf{u}) + \frac{1}{2} \nabla (g H^2) = -g H \nabla h - f_c \times (H \mathbf{u}) + \mathbf{S},
\end{cases}
\tag{1}
$$

where the unknowns are the total water column thickness $H = h(x,y) + \eta(x,y,t)$, with $h$ the still-water bathymetric depth, $\eta$ the free surface elevation; and the horizontal speed mean $\mathbf{u}(t,x,y)$. The parameter $f_c$ is linked to the angular speed of the earth's rotation, and $\mathbf{S}$ is the source term, i.e. viscosity terms for the closure problem. The momentum equation of then $(1)$ becomes

$$
\partial_t (H \mathbf{u}) + \nabla \cdot (H \mathbf{u} \otimes \mathbf{u}) + \frac{1}{2} \nabla (g H^2) = -g H \nabla h - f_c \times H \mathbf{u} + \mathbf{S} + \nu \Delta (H\mathbf{u}),
\tag{2}
$$

For simplicity, we rewrite system $(2)$ in a conservative flux form,

$$
\frac{\partial \mathbf{U}}{\partial t}
+\frac{\partial \mathbf{F}(\mathbf{U})}{\partial x}
+\frac{\partial \mathbf{G}(\mathbf{U})}{\partial y}
= \mathbf{S}(\mathbf{U}),
$$

with fluxes

$$
\mathbf{F}(\mathbf{U})=
\begin{pmatrix}
Hu \\
Hu^{2}+\frac12 gH^{2} \\
Huv
\end{pmatrix},
\qquad
\mathbf{G}(\mathbf{U})=
\begin{pmatrix}
Hv \\
Huv \\
Hv^{2}+\frac12 gH^{2}
\end{pmatrix}.
$$

Let $f_c(x,y)$ be the Coriolis parameter, $\rho_w$ water density, $p_a(x,y,t)$ atmospheric pressure, $\boldsymbol{\tau}_w=(\tau_{wx},\tau_{wy})$ wind stress at the surface, and $\boldsymbol{\tau}_b$ bottom stress. Then

$$
\mathbf{S}(\mathbf{U})=
\begin{pmatrix}
-gH \partial_x h \\
-gH \partial_y h
\end{pmatrix}
+
\begin{pmatrix}
fHv \\
-fHu
\end{pmatrix}
+
\begin{pmatrix}
-\dfrac{H}{\rho_w}\partial_x p_a \\
-\dfrac{H}{\rho_w}\partial_y p_a
\end{pmatrix}
+
\begin{pmatrix}
\dfrac{1}{\rho_w}\tau_{wx} \\
\dfrac{1}{\rho_w}\tau_{wy}
\end{pmatrix}

\begin{pmatrix}
\dfrac{1}{\rho_w}\tau_{bx} \\
\dfrac{1}{\rho_w}\tau_{by}
\end{pmatrix}.
$$

## Common closures

### Bottom stress
Quadratic drag
$$
\begin{align*}
-\frac{1}{\rho_w}\boldsymbol{\tau}_b &= -C_d|\mathbf{u}|\mathbf{u}.
\end{align*}
$$

Manning's
$$
\begin{align*}
-\frac{1}{\rho_w}\boldsymbol{\tau}_b &= -gn^2H^{-1/3}|\mathbf{u}|\mathbf{u}.
\end{align*}
$$

### Wind stress
Quadratic drag
$$
\frac{1}{\rho_{wx}} \boldsymbol{\tau}_w = \frac{\rho_a}{\rho_w} C_D |\mathbf{u_{10}}|\mathbf{u_{10}}
$$

<a href="http://dx.doi.org/10.1175/1520-0485(1981)011<0324:OOMFMI>2.0.CO;2"> Large & Pond (1981) </a>
$$
C_D =
\begin{cases}

(1.2 + 0.04 U_{10}) \times 10^{-3} &,U_{10} < 11 \; \mathrm{ms^{-1}} \\
(0.49 + 0.065 U_{10}) \times 10^{-3} &,11 \leq U_{10} \leq 25

\end{cases}
$$

Powell / <a href="https://doi.org/10.1029/2004GL019460"> Donelan (2004) </a>
$$
C_D =
\begin{cases}

C_{D0} + \alpha U_{10} &,U_{10} \leq U_c \\
C_{D,max} \approx (2.0-2.5) \times 10^{-3} &,U_{10} > U_c

\end{cases}
$$
